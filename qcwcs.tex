\subsection{Article}

\subsubsection*{Abstract}
The safety of a quantum key distribution system relies on the fact that any eavesdropping attempt on the quantum channel creates errors in the transmission. For a given error rate, the amount of information that may have leaked to the eavesdropper depends on both the particular system and the eavesdropping strategy. In this work, we discuss quantum cryptographic protocols based on the transmission of weak coherent states and present anew system, based on a symbiosis of two existing ones, and for which the information available to the eavesdropper is significantly reduced. This system is therefore safer than the two previous ones. We also suggest a poss experimental implementation.

\subsubsection{Introduction}
The only known method to exchange secret information through a communication channel in a proven secure way, is to use the so-called one-time pad (for a good review of both classical and quantum cryptography, see [1]). In this technique, the data, which is represented by a string of bits, is combined with a random string of bits of equal length called the key, and is then sent through the communication channel. The randomness of the key ensures that the encoded message is also completely random and as such totally unintelligible to a potential eavesdropper. The safety of the transmission is thus entirely dependent on the safety of the key, which has to be secret and shared just by both legitimate users. Moreover,safety can be guaranteed only if the key is used once, and then discarded. The problem is therefore how to distribute the random key between users in a secure way. Classically,the only possibility is either through personal meetings, or through a trusted courier, which makes the technique rather expensive, and not practical for many applications. Therefore,most practical cryptographic systems nowadays rely on different principles [1]. However,these cannot really guarantee the safety of the transmission, but rely on a weaker property of the system, namely that it is computationally safe. This means that the system can be broken in principle, but that the computation time required to do so is too long to pose a real threat. The main problem with this approach is that its safety could be destroyed by technological progress (faster computers) or mathematical advances (faster algorithms or future theoretical progress in computation theory). Another technique, whose safety does not rely on computing abilities, and which was only recently developed, is quantum cryptography(for an introduction, see [2]).

In quantum cryptography, the two users, generally referred to as Alice (the sender) and Bob (the receiver), have two kinds of communication channels at their disposal. One is a classical public channel, which can be overheard by anybody, but cannot be modified;and the second is a quantum channel, whose main characteristic is that any attempt at eavesdropping will create errors in the transmission. The quantum channel will be used to transmit the secret key, and the classical public channel will be used to exchange information and to send the encoded message. In principle, this is sufficient to ensure the safety of a transmission: Alice and Bob exchange a series of bits over the quantum channel, and then use part of the transmission to test for eavesdropping. If they find any discrepancy between their strings, they can infer that an eavesdropper, usually referred to as Eve, was listening and that their transmission is not secret. If they detect no errors, they can assume that the key is safe. By testing a large proportion of their initial string, they can attain any safety level they wish. Unfortunately, quantum channels are very sensitive devices, and due to the imperfections of the channels and of the detectors, some errors will always be unavoidable. The problem facing Alice and Bob is therefore, for a given error rate, to estimate the amount of information that may have leaked to Eve, and decide on the safety of the transmission. This of course depends on both the particular system used by Alice and Bob, and on the eavesdropping strategy adopted by Eve. A safer system is a system for which the amount of information that may have leaked to Eve is lower. If the information leaked to Eve is not too high, Alice and Bob can use classical information processing techniques to reduce it to approximately zero, at the expense of shortening their strings [3–5].

At present, there exist three different quantum cryptographic systems. The first one relies on the transmission of single photons randomly polarized along four directions [6].
As single photons are difficult to produce experimentally, a slight modification of this system, using weak pulses instead of single photons, was the first one to be implemented in practice [3,7,8]. The second system, which is conceptually the simplest, uses only two non orthogonal quantum states [9]. Its implementation relies on weak coherent pulses, with a phase difference between them [9,10]. The third system is based on the creation of pairs of EPR correlated photons [11]. One of its potential advantages is that the correlations are between single photons and not weak pulses, which can be a great advantage, as we shall emphasize later. However, creation and transmission over long distances of EPR correlated pairs is technologically more difficult, and it is not clear yet whether this will prove practical [12]. In this work, we focus on quantum cryptographic schemes implemented with weak pulses of coherent light. We compare the safety of the first and the second of these quantum cryptographic systems, and present a new system, which is a symbiosis of both, and for which the safety can be significantly increased.

In Section II, we analyze the first system, referred to as 4-states system. In Section III,we turn to the second one, named 2-states system, and present a new implementation.
We introduce our new 4+2 system in Section IV, and show that it is more sensitive to eavesdropping than the two previous ones. In Section V, we show the dangers associated with a lossy transmission line, and conclude in Section V

\subsubsection{4-STATES PROTOCOL}

This protocol was developed by Bennett et al. [6]. The sender, Alice, chooses at random one out of four states, e.g. for polarized photons: |, <->, / or /, and sends it to the receiver, Bob. The two states - and | stand for bit value ‘0’, while the other two, <-> and /, stand for ‘1’. Bob chooses, also at random, a basis in which he measures the polarization. When his basis corresponds to Alice’s, his bit should be perfectly correlated with hers, whereas when his basis is the conjugate, there is no correlation between his result and Alice’s original choice. By discussing over the public channel, Alice and Bob agree to discard all the instances where they did not use the same basis (half of the total on average).

The result is what we call the sifted key, which should be two perfectly correlated strings,but which may contain errors. The two fundamental properties of this protocol are:(i) the choice of basis is completely hidden from the other protagonist (the two bases correspond to the same density matrix), as well as from any mischievous eavesdropper,Eve;(ii) when Alice and Bob use different bases, there is no correlation between their bits.

The first one, (i), ensures that, as the eavesdropper Eve cannot know which basis was used,she will unavoidably introduce errors. The second one, (ii), is not really necessary, but is preferable, as it reduces the information available to Eve to a minimum [13] (25 \% for each photon on which she eavesdropped). There have been various works analyzing eavesdropping strategies, calculating the information available to Eve as a function of the error rate and developing information processing techniques to reduce it to any required level [3–5,14].

One technical difficulty with this scheme is that in principle it should be implemented by means of single photons [6]. As these are difficult to generate experimentally, existing schemes rely on weak pulses of coherent or thermal light, with much less than one photon per pulse on average [3,7,8]. This ensures that the probability of having two or more photons in a pulse remains very small. This strategy reduces the transmission rate (recent experiments use about one tenth of a photon per pulse), while providing no advantage to an honest participant. More precisely, if Alice and Bob use coherent pulses, the transmission rate t, where the factor 1/2 comes from the fact that half of the transmissions had to be discarded(when Alice and Bob used different bases). In fact, even for these weak pulses, the probability of having two or more photons per pulse may not always be neglected (for the above pulses,one out of twenty non-zero pulses will have two photons). We shall show in Section V how to take this into account.

In order to get quantitative results, we shall assume that Eve uses the intercept resend strategy: she intercepts the pulses, attempts to gain as much information as possible, and sends to Bob a new pulse, prepared according to the information she obtained. Moreover,we shall assume that she eavesdrops in the bases used by Alice and Bob. This is the intercept/resend strategy which provides her with the most information on the sifted key [5]. However, it is not yet known whether this is the optimal strategy. It is easy to see that, when Eve eavesdrops on a fraction n of the transmissions, the error rate created is n/4 (when Eve uses the correct basis, she does not introduce any error, while she creates a 50\% error rate when she uses the wrong basis), and that the information she obtained is n/2 (she has total information when she used the correct basis, and none when she used the wrong one). Moreover, the scheme is completely symmetric, so that Eve shares the same information with Alice and with Bob. Therefore, we can write the mutual information shared by Alice and Eve and shared by Eve and Bob as a function of the error rate Q:I
(4)AE(Q) = I(4)EB(Q) = 2Q . (2)In this system, the intensity of the weak pulses, or equivalently the transmission rate t(4)defined in (1) has no influence. In the following, we will compare (2) to the information obtained by Eve for the other two system.

\subsubsection{2-STATES PROTOCOL}
In this protocol [9], Alice chooses between only two non-orthogonal states, and sends one to Bob. As these are not orthogonal, there is no way for Bob to decode them deterministically. However, by means of a generalized measurement, also known as positive operator valued measure or POVM [15,16], he can perform a test which will sometimes fail to give an answer, and at all other times give the correct one. In essence, instead of having a binary test (with results 0 or 1), which will unavoidably create errors when the two states are not orthogonal, Bob has a ternary system, with possible results: 0, 1, or ? (with ? corresponding to inconclusive results). For example, if Alice sends a 0, Bob may get either a 0 or an inconclusive result, but he will never get a 1. We present a practical implementation of such a POVM in the next Section (for a theoretical description see [15,16]). As with the previous system, Alice and Bob use their public channel to discard all the inconclusive results. They should now have two perfectly correlated strings, except for possible errors. The safety of the protocol against eavesdropping is ensured by the fact that Eve cannot get deterministic results either. She may attempt to get as much information as possible by projecting the states onto an orthogonal basis. This is discussed in Section III C, where we show that this will unavoidably create errors. Another possibility for Eve is to mimic Bob’s measurement,and obtain deterministic results on a fraction of the bits. However, in this case, she will have to guess Alice’s choice on the remaining bits, and this will provide her with less information than the previous strategy. Let us emphasize that, as we want Eve’s guesses to result in errors on Bob’s side, this scheme should not be implemented with weak pulses only. In this case, Eve could simply intercept the transmission, resend a pulse to Bob only when she managed to obtain the bit sent by Alice (i.e. 0 or 1), and send nothing when she obtained an inconclusive result. The signature of eavesdropping would then just be a reduction in the transmission rate. In the original proposal, this is overcome by using phase encoding of a weak pulse (the two states are, with overlap e 2a ), which is sent together with a strong pulse, used also as a phase reference [9,10]. When Eve fails to obtain information,she still has to send the strong pulse, which will create errors in the reception. Ekert etal. [16] recently analyzed various eavesdropping strategies related to this system. Here, we shall restrict ourselves to the intercept/resend strategy and compare the safety of various schemes.

Let us now suggest a new implementation of the 2 states system, which will be later extended to our new 4 + 2 protocol. We shall call it parallel reference implementation, to distinguish it from the sequential reference implementation of [9]. Alice uses weak coherent states, with phase encoding 0 or pi with respect to a strong coherent state. We denote the weak states  and the strong state. Instead of sending the two states one after the other, Alice uses two orthogonal polarizations: |, say, will have vertical polarization, and b will have horizontal polarization. The decoding on Bob’s side is schematized in Fig. 1. The two states are separated by a polarization beam splitter (PBS). b is rotated to vertical polarization and sent through a mainly transmitting beam splitter (BS1) to detector D1. A small fraction of b, equal to 'a', is sent to interfere with 'a' at BS2, and towards two detectors D2 and D3. A count in D2, say, corresponds to phase zero, while a count in D3 corresponds to pi. No count in both D2 and D3 is of course an inconclusive result. It is easy to calculate the probability of such a result: which is equal to the overlap between the two states. It was shown that (4) represents the optimum for separating deterministically two non-orthogonal states [17]. Detector D1 should always fire, and can therefore be used as a trigger for the other two,enabling them only for a short time corresponding to the length of the pulse (this will reduce the dark counts). Moreover, an eavesdropper with an inconclusive result would still have to send b, which will result in random counts in D2 and D3. A small modification of the above will be used for our 4 + 2 protocol.

As in Section II, we assume that Eve performs an intercept/resend strategy, and attempts to get as much information as possible on the state sent by Alice. This is obtained by projecting it onto the orthogonal basis B sym = (i, j) as shown in Fig. 2 [15], and provides Eve with probabilistic information only. Another method for Eve would be to use the same POVM as Bob. This would provide her with a smaller amount of deterministic information. The error rate introduced by Eve is equal to the probability of making the wrong reading,e.g. the probability of obtaining j when the input was in fact . With this particular eavesdropping strategy,the transmission channel Alice-Eve is known as a binary symmetric channel, and is fully characterized by the error rate q [18]. The mutual information shared by Alice and Eve is equal to the channel capacity and is given by [16]:
b is the maximum information that can be extracted from two states with overlap cos b. On the other hand, after Bob discards all his inconclusive results, the transmission channel Eve-Bob is perfect. Therefore the mutual information Eve-Bob is:i EB = 1 .
(8)This strategy, where Eve eavesdrops on all the transmitted photons, will create a high error rate. In order to reduce it, Eve shall only eavesdrop on a fraction n of the transmissions,thus creating an error rate Q = nq = n

It is now easy to obtain the mutual information between Alice and Eve, I AE and between(2)Eve and Bob, I EB , as a function of the error rate Q and the angle b between the states: we can also write the mutual information as a function of the transmission rate for each value of the error rate. These functions are plotted in Fig 3, where the information gained for the 4-states system is used as a references.

\subsubsection{4 + 2 PROTOCOL}

The basic idea behind this protocol is that the 4-states scheme does not require the two states in each basis to be orthogonal. The safety of this scheme relies entirely on the two points (i) and (ii) mentioned in Section II. Any scheme using two pairs of states (each pair corresponding to one non-orthonormal basis) satisfying both (i) and (ii) is an equally good candidate for a 4-states protocol. Moreover, by choosing non-orthogonal states in each pair, we will get the additional advantage of the 2-states protocol, namely that Eve cannot differentiate deterministically between the two states in each basis. As we show in the following, this will make the scheme more sensitive to eavesdropping. A second advantage,shared with the 2-states system, is that this scheme will be more resilient in the case of a lossy transmission line. This aspect will be discussed in Section V. A graphic comparison between the different systems is given in Fig 4, where we plot the various states on the Poincaré sphere.

Let us apply this to our previous parallel reference phase encoding scheme. The first pair will correspond to 0 and p phase shifts, while the second pair will correspond to p/2 and 3p/2. Explicitly, the four states are: |ai, | - ai, |iai and | - iai. Let us emphasize that these states satisfy condition (i) only when the intensity is low enough, since pulses containing two or more photons do not satisfy it. Indeed, if we take into account the two photon number state, it is easy to see that the two pairs: | +- ai and | +- iai are not even in the same 2D Hilbert space, and therefore cannot correspond to the same density matrix. In the following, we shall assume that this condition is verified. We shall however lift this restriction in Section V, where we present an analysis for a lossy transmission line.

The detection system is similar to the one explained in Section III, with the addition of an optional p/2 phase shifter in one arm of the interferometer (see Fig. 1). When Bob wants to measure in the first basis, he does not put the phase shift, and his detection scheme will therefore differentiate between |ai and | - pi. When he wants to measure in the second basis, he puts the p/2 phase shift, so that his detection scheme will now differentiate between|iai and | - iai. Of course, when Bob uses the wrong basis (say Alice sent state |ai and Bob puts the p/2 phase shift), Bob’s result is totally uncorrelated with Alice’s choice. In many instances Bob won’t get any count in his detectors D2 and D3, which correspond to in conclusive results, and will be discarded.

The problems facing Eve are now twofold: she doesn’t know the basis used by Alice (a sin the 4-states method), which means that even when she has a conclusive result, she cannot be sure that it is relevant. Moreover, as the states are not orthogonal, she is faced with two possibilities: either to try to get deterministic results, which means that in many instances she will get no information at all, but will still have to make a decision on which state to send to Bob; or try to get probabilistic information, in which case she will know very little on each bit. In both cases, she will introduce errors, before she even start to deal with the basis. This is the main difference with the usual 4-states scheme: Alice and Bob make use of the fact that they send weak pulses and not single photons to enhance the safety.

The comparison between the three systems is given in Fig 3, where we plot the various information as functions of the transmission rate, and use the 4-states system as a reference. Note that, as the transmission rate is different for the 2-states system and the 4+2 system,we compare systems with different values of a (or equivalently with different values of the overlap cos b). With the type of eavesdropping strategy considered here, the information available to Eve grows linearly with the error rate for all the systems. Therefore, as the plot is normalized with respect to the 4-states system, there is no dependence on Q. Fig 3shows a clear advantage for the 2-states system with respect to the 4-states system at very low transmission rates. However, the information leaked to Eve increases rapidly with the transmission rate. In contrast, the 4+2 system is always preferable to both other systems. Let us emphasize that our analysis is in principle correct for any value of the overlap cos b between the states, if the various states remain in a 2D Hilbert space. However, this is not the case for the suggested implementation with weak coherent states. In this case, the analysis is only appropriate for very weak states, where the probability of having more than one photon is sufficiently small, and therefore where the overlap between the states is always close to one. This is likely to be correct in practical applications, but it is still important to present the corrections to the analysis when two-photon states become relevant. This is the task of Section V.

\subsubsection{LOSSY TRANSMISSION LINE}

In the above work, we have analyzed the relative sensitivity of various schemes to eavesdropping, under the assumption that there was at most one photon per pulse. However,when we use pulses of coherent or thermal light, there is a non-zero probability to have more than one photon in a pulse, even for very weak pulses. When the transmission line between Alice and Bob is approximately lossless, the fact that a few pulses may have more than one photon is not too damaging, but only gives some free information to an eavesdropper. However, when the transmission line is lossy, using weak pulses can prove disastrous for Alice and Bob. Let us assume that the transmission line is a silica optical fiber, which is always slightly lossy (about 0.2 dB/km). If we want to use the cryptographic system over reasonable distances, say up to 50 km, transmission losses will be as high as 10 dB, or about 90. An eavesdropper with superior technology could replace the fiber by a perfectly transparent one, and use the excess power for her mischievous purposes.

For the 4-states system based on polarization (Section II), this can be very damaging. Indeed, as polarization and photon number are independent variables, there is no problem in principle to select the few pulses with two or more photons and separate them into two one-photon pulses, without changing the polarization. Eve could then send one of the two pulses to Bob, while keeping the other one. She would measure her signal only after Alice and Bob have disclosed their bases, which means that she will get complete information on these pulses. If the pulses sent by Alice are coherent and contain on average 1/10 photon,Eve would obtain about one such pulse out of 200, and would send all of these to Bob without attenuation. Remembering that Bob only expect to receive one photon out of 100 pulses sent by Alice, we see that Eve can know the polarization of half of the pulses received by Bob, without creating any error. For thermal light, where the photon distribution is wider(one pulse out of 100 would contain more than one photon), Eve would actually know the polarization of all the pulses. This can of course be reduced by using even weaker pulses,but this in turn would lower the transmission rate and the signal to noise ratio (mainly because of the dark counts of the detectors). This shows that a combination of weak pulses with high channel loss is a deadly combination for this cryptographic system. If the losses are high enough, Eve can get full information on the transmission, and this without causing a single error. Let us emphasize however that any system using only single photons would be insensitive to the above attack.

In contrast to the 4-states system, both the 2-states systems based on phase encoding(Section III), and our new protocol (Section IV) will be more resilient against this attack. The main reason is that as phase and number are conjugate variables, any attempt by Eve to select the two-photon pulses will unavoidably randomize the phase of the pulse. Therefore,the best Eve can do is to split the incoming pulses, and send to Bob the weaker pulses through a lossless fiber. For the 90\% losses mentioned above, Eve can therefore split 90\% of the pulses. Bob of course has no way of discovering that the losses are now due to Eve. The malicious Eve can now keep her pulses, wait for Alice and Bob to disclose the basis they used, and then try to extract the maximum information from them. In contrast to the 4-states system, her information is limited by the fact that the states are not orthogonal. In fact, the maximum information that she can extract is given by ib defined in (7). For the above example, with 1/10 photon per pulse on average and 90\% losses, Eve has pulses with 0.09 photons at her disposal. The maximum information that she can extract is then about 0.23 bits. In a practical scheme, this would have to be added to the information available to Eve as a function of the error rate. Let us emphasize that Eve can adopt this beam splitting strategy, even in the case of 4-states systems with weak pulses. However,as was shown in the previous paragraph, in this case she can also use the independence of polarization and photon number to get more information. 


\subsubsection{CONCLUSION}

The rule of the game in quantum cryptography is that the honest participants are limited by the available technology, while the mischievous eavesdropper is only confined by the laws of quantum mechanics. This is in order to ensure that the safety of the schemes does not depend on future technological advances, no matter how unlikely. At present, one of the main technological limitations is the difficulty of generating single photons. For this reason, most existing schemes rely on weak pulses, which are easy to generate. However,in practical implementations [3,7,8], this fact was considered to be only a limitation. The fact that the pulses had a strong vacuum component, or equivalently the fact that the two pulses in the same basis were not orthogonal, was not utilized by the users. In this work, we presented a new system which made use of this vacuum component to enhance the safety of the transmission.

The reason why the task of the eavesdropper is made more difficult with this system, is that it combines the strengths of the two systems it is built from: as in the 4-states system,Eve does not know the basis used by Alice and Bob; as in the 2-states system, she cannot distinguish with certainty between the two non-orthogonal states. It is worth noting that the usual implementation of the 4-states system with weak pulses actually satisfies these two criteria. The weak pulses with orthogonal polarizations are not orthogonal in the Hilbert space, due to their common vacuum component. The ingredient which is missing from these system is the use of a strong reference pulse in the detection, which ensures that Eve has to send a signal to Bob, even when she could not get any information on the signal sent by Alice. When this is added to the system, the use of weak pulses becomes an advantage for the legitimate users. Indeed, one experimental realisation of quantum cryptography based on an interferometric scheme [7], is somewhat similar to our suggested implementation (see Fig 1). The main difference between the two schemes is that [7] do not use a strong reference pulse(in their set-up, |b| 2 = |a| 2 , and the beam splitter BS1 is replaced by a mirror). Therefore,as emphasized above, their scheme does not take advantage of the non-orthogonality of the weak pulses. Whenever she obtains an unsatisfactory result in her attempt to eavesdrop,Eve may simply block the transmission and send nothing to Bob. A slight modification of the existing experiment could therefore provide a much safer scheme.

\subsection{\trnas}


\subsubsection*{Аннотация}
Безопасность системы квантового распределения ключей зависит от того, что любая попытка подслушивания в квантовом канале приводит к ошибкам при передаче. Для заданного коэффициента ошибок количество информации, которая может попасть к подслушивающему, зависит как от конкретной системы, так и от стратегии подслушивания. В этой работе мы обсуждаем квантовые криптографические протоколы, основанные на передаче слабых когерентных состояний, и представляем новую систему, основанную на комбинации двух существующих, для которой информация, доступная подслушивающему, значительно уменьшается. Таким образом, эта система является более безопасной, чем две предыдущие. Мы также предлагаем возможную экспериментальную реализацию.

\subsubsection{Введение}
Единственным известным методом обмена секретной информацией по каналу связи в условиях доказанной безопасности является использование так называемого одноразового блокнота (хороший обзор классической и квантовой криптографии см. в [1]). В этой технике данные, представленные строкой бит, объединяются со случайной строкой бит равной длины, называемой ключом, и затем передаются по каналу связи. Случайность ключа гарантирует, что закодированное сообщение также является абсолютно случайным и, следовательно, абсолютно неразборчивым для потенциального подслушивающего устройства. Таким образом, безопасность передачи полностью зависит от безопасности ключа, который должен быть секретным и передаваться только обоим легитимным пользователям. Более того, безопасность может быть гарантирована только в том случае, если ключ используется один раз, а затем выбрасывается. Поэтому проблема заключается в том, как безопасно распределить случайный ключ между пользователями. Классически, единственной возможностью является либо личная встреча, либо передача через доверенного курьера, что делает эту технику довольно дорогой и непрактичной для многих приложений. Поэтому большинство практических криптографических систем сегодня опираются на различные принципы [1]. Однако они не могут гарантировать безопасность передачи, а полагаются на более слабое свойство системы, а именно на то, что она является вычислительно безопасной. Это означает, что система в принципе может быть взломана, но время вычислений, необходимое для этого, слишком велико, чтобы представлять реальную угрозу. Основная проблема этого подхода заключается в том, что его безопасность может быть разрушена технологическим прогрессом (более быстрые компьютеры) или математическим прогрессом (более быстрые алгоритмы или будущий теоретический прогресс в теории вычислений). Другая техника, безопасность которой не зависит от вычислительных возможностей и которая была разработана совсем недавно, - это квантовая криптография (введение см. в [2]).

В квантовой криптографии два пользователя, обычно называемые Алиса (отправитель) и Боб (получатель), имеют в своем распоряжении два вида каналов связи. Один из них - классический открытый канал, который может быть подслушан кем угодно, но не может быть изменен; а второй - квантовый канал, основная характеристика которого заключается в том, что любая попытка подслушивания приведет к ошибкам в передаче. Квантовый канал будет использоваться для передачи секретного ключа, а классический открытый канал - для обмена информацией и передачи закодированного сообщения. В принципе, этого достаточно для обеспечения безопасности передачи: Алиса и Боб обмениваются сериями битов по квантовому каналу, а затем используют часть передачи для проверки на подслушивание. Если они обнаружат какое-либо расхождение между их строками, они могут сделать вывод, что подслушивающее лицо, обычно называемое Евой, прослушивало их и что их передача не является секретной. Если они не обнаруживают ошибок, они могут предположить, что ключ безопасный. Проверяя большую часть своей начальной строки, они могут достичь любого уровня безопасности. К сожалению, квантовые каналы - очень чувствительные устройства, и из-за несовершенства каналов и детекторов некоторые ошибки всегда будут неизбежны. Поэтому проблема, стоящая перед Алисой и Бобом, заключается в том, чтобы для заданной частоты ошибок оценить количество информации, которая могла просочиться к Еве, и принять решение о безопасности передачи. Это, конечно, зависит как от конкретной системы, используемой Алисой и Бобом, так и от стратегии подслушивания, принятой Евой. Более безопасная система - это система, в которой количество информации, которая могла попасть к Еве, меньше. Если объем информации, просочившейся к Еве, не слишком велик, Алиса и Боб могут использовать классические методы обработки информации, чтобы уменьшить его приблизительно до нуля, за счет укорачивания своих строк [3-5].

В настоящее время существует три различных квантовых криптографических системы. Первая основана на передаче одиночных фотонов, случайно поляризованных по четырем направлениям [6].
Поскольку одиночные фотоны трудно получить экспериментально, небольшая модификация этой системы, использующая слабые импульсы вместо одиночных фотонов, была первой реализована на практике [3,7,8]. Вторая система, которая концептуально является самой простой, использует только два неортогональных квантовых состояния [9]. Ее реализация основана на слабых когерентных импульсах с разностью фаз между ними [9,10]. Третья система основана на создании пар ЭПР-коррелированных фотонов [11]. Одним из ее потенциальных преимуществ является то, что корреляции происходят между одиночными фотонами, а не слабыми импульсами, что может быть большим преимуществом, как мы подчеркнем далее. Однако создание и передача на большие расстояния ЭПР-коррелированных пар технологически сложнее, и пока неясно, будет ли это практичным [12]. В этой работе мы сосредоточимся на квантовых криптографических схемах, реализуемых с помощью слабых импульсов когерентного света. Мы сравниваем безопасность первой и второй из этих квантовых криптографических систем и представляем новую систему, которая является симбиозом обеих, и для которой безопасность может быть значительно увеличена.

В разделе II мы анализируем первую систему, называемую 4-статусной. В разделе III мы переходим ко второй системе, названной 2-статусной, и представляем новую реализацию.
В разделе IV мы представляем нашу новую систему 4+2 и показываем, что она более чувствительна к подслушиванию, чем две предыдущие. В разделе V мы показываем опасности, связанные с линией передачи с потерями, и делаем вывод в разделе V.

\subsubsection{Протокол с 4-мя состояниями}

Этот протокол был разработан Беннеттом и другими [6]. Отправитель, Алиса, выбирает случайным образом одно из четырех состояний, например, для поляризованных фотонов: |, <->, / или /, и отправляет его получателю Бобу. Два состояния - и | означают значение бита "0", а два других, <-> и /, означают "1". Боб выбирает, также случайным образом, базис, в котором он измеряет поляризацию. Когда его базис соответствует базису Алисы, его бит должен идеально коррелировать с ее битом, в то время когда его базис сопряжен, нет никакой корреляции между его результатом и первоначальным выбором Алисы. Обсуждая по общедоступному каналу, Алиса и Боб договариваются отбросить все случаи, когда они не использовали один и тот же базис (в среднем половина от общего числа).

В результате получается то, что мы называем просеянным ключом, который должен представлять собой две идеально коррелированные строки, но который может содержать ошибки. Два фундаментальных свойства этого протокола: (i) выбор базиса полностью скрыт от другого действующего лица (два базиса соответствуют одной и той же матрице плотности), а также от любого подслушивающего устройства, Евы; (ii) когда Алиса и Боб используют разные базисы, между их битами нет корреляции.

Первый, (i), гарантирует, что, поскольку подслушивающая Ева не может знать, какой базис был использован, она неизбежно внесет ошибки. Второе, (ii), на самом деле не является необходимым, но предпочтительнее, так как сокращает информацию, доступную Еве, до минимума [13] (25 \% для каждого фотона, на котором она подслушивала). Существуют различные работы, анализирующие стратегии подслушивания, вычисляющие доступную Еве информацию как функцию коэффициента ошибок и разрабатывающие методы обработки информации для снижения ее до любого требуемого уровня [3-5,14].

Одна из технических трудностей этой схемы заключается в том, что в принципе она должна быть реализована с помощью одиночных фотонов [6]. Поскольку их трудно генерировать экспериментально, существующие схемы полагаются на слабые импульсы когерентного или теплового света, со средним количеством фотонов намного меньше одного на импульс [3,7,8]. Это гарантирует, что вероятность наличия двух или более фотонов в импульсе остается очень малой. Такая стратегия снижает скорость передачи (в последних экспериментах используется около одной десятой фотона на импульс), не давая при этом никаких преимуществ участнику. Более точно, если Алиса и Боб используют когерентные импульсы, скорость передачи t, где коэффициент 1/2 происходит от того, что половина передач должна быть отброшена (когда Алиса и Боб использовали разные базы). На самом деле, даже для таких слабых импульсов, вероятностью наличия двух или более фотонов в импульсе не всегда можно пренебречь (для приведенных выше импульсов, один из двадцати ненулевых импульсов будет иметь два фотона). В разделе V мы покажем, как это учесть.

Чтобы получить количественные результаты, мы предположим, что Ева использует стратегию перехвата и пересылки: она перехватывает импульсы, пытается получить как можно больше информации и посылает Бобу новый импульс, подготовленный в соответствии с полученной информацией. Более того, мы будем считать, что она подслушивает базы, используемые Алисой и Бобом. Именно такая стратегия перехвата/передачи дает ей наибольшую информацию о просеянном ключе [5]. Однако пока неизвестно, является ли эта стратегия оптимальной. Легко видеть, что, когда Ева подслушивает часть n передач, уровень создаваемых ошибок составляет n/4 (когда Ева использует правильную основу, она не вносит никакой ошибки, в то время как при использовании неправильной основы она создает 50\% ошибок), и что полученная ею информация составляет n/2 (она имеет полную информацию, когда использует правильную основу, и никакую, когда использует неправильную). Более того, схема полностью симметрична, так что Ева делится одинаковой информацией с Алисой и с Бобом. Следовательно, мы можем записать взаимную информацию, разделяемую Алисой и Евой и разделяемую Евой и Бобом, как функцию коэффициента ошибок Q:I
(4)AE(Q) = I(4)EB(Q) = 2Q . (2)В этой системе интенсивность слабых импульсов, или, эквивалентно, скорость передачи t(4)определенная в (1), не имеет никакого влияния. Далее мы сравним (2) с информацией, полученной Евой для двух других систем.

\subsubsection{Протокол с 2-мя состояниями}
В этом протоколе [9] Алиса выбирает только два неортогональных состояния и посылает одно из них Бобу. Поскольку они не ортогональны, у Боба нет возможности детерминированно декодировать их. Однако с помощью обобщенного измерения, также известного как положительная операторная мера или POVM [15,16], он может провести тест, который иногда не даст ответа, а в остальное время будет давать правильный ответ. По сути, вместо бинарного теста (с результатами 0 или 1), который неизбежно приведет к ошибкам, если два состояния не ортогональны, Боб имеет троичную систему с возможными результатами: 0, 1 или ? (при этом ? соответствует неокончательным результатам). Например, если Алиса посылает 0, Боб может получить либо 0, либо неокончательный результат, но он никогда не получит 1. В следующем разделе мы представим практическую реализацию такой POVM (теоретическое описание см. в [15,16]). Как и в предыдущей системе, Алиса и Боб используют свой открытый канал, чтобы отбросить все неубедительные результаты. Теперь у них должны быть две идеально коррелированные строки, за исключением возможных ошибок. Безопасность протокола от подслушивания обеспечивается тем, что Ева также не может получить детерминированные результаты. Она может попытаться получить как можно больше информации, проецируя состояния на ортогональный базис. Это обсуждается в разделе III C, где мы показываем, что это неизбежно приведет к ошибкам. Другая возможность для Евы - имитировать измерения Боба и получить детерминированные результаты на части битов. Однако в этом случае ей придется угадывать выбор Алисы по оставшимся битам, и это даст ей меньше информации, чем предыдущая стратегия. Подчеркнем, что, поскольку мы хотим, чтобы догадки Евы приводили к ошибкам на стороне Боба, эту схему не следует реализовывать только со слабыми импульсами. В этом случае Ева могла бы просто перехватить передачу, повторно послать Бобу импульс только тогда, когда ей удалось получить бит, посланный Алисой (т.е. 0 или 1), и ничего не посылать, когда она получила неубедительный результат. Тогда признаком подслушивания будет просто снижение скорости передачи. В оригинальном предложении это преодолевается с помощью фазового кодирования слабого импульса (два состояния, с перекрытием e 2a ), который посылается вместе с сильным импульсом, используемым также в качестве фазового эталона [9,10]. Когда Еве не удается получить информацию, ей все равно приходится посылать сильный импульс, который будет создавать ошибки при приеме. Ekert etal. [16] недавно проанализировали различные стратегии подслушивания, связанные с этой системой. Здесь мы ограничимся стратегией перехвата/передачи и сравним безопасность различных схем.

Теперь предложим новую реализацию системы 2 состояний, которая впоследствии будет расширена на наш новый протокол 4 + 2. Мы будем называть ее параллельной эталонной реализацией, чтобы отличить ее от последовательной эталонной реализации из [9]. Алиса использует слабые когерентные состояния, с фазовым кодированием 0 или pi по отношению к сильному когерентному состоянию. Мы обозначаем слабые состояния и сильное состояние. Вместо того чтобы посылать два состояния одно за другим, Алиса использует две ортогональные поляризации: |, скажем, будет иметь вертикальную поляризацию, а b - горизонтальную. Декодирование на стороне Боба схематично показано на рис. 1. Два состояния разделяются поляризационным делителем луча (PBS). b поворачивается к вертикальной поляризации и посылается через преимущественно передающий делитель луча (BS1) на детектор D1. Небольшая часть b, равная 'a', направляется на интерференцию с 'a' в BS2 и на два детектора D2 и D3. Счет в D2, скажем, соответствует фазе ноль, а счет в D3 соответствует $\pi$. Отсутствие отсчетов как в D2, так и в D3, конечно, является неубедительным результатом. Легко вычислить вероятность такого результата: она равна перекрытию между двумя состояниями. Было показано, что (4) представляет собой оптимум для детерминированного разделения двух неортогональных состояний [17]. Детектор D1 должен срабатывать всегда, поэтому его можно использовать как триггер для двух других, включая их только на короткое время, соответствующее длительности импульса (это уменьшит количество темных отсчетов). Более того, подслушивающее устройство с неубедительным результатом все равно должно будет послать b, что приведет к случайным отсчетам в D2 и D3. Небольшая модификация вышеописанного будет использована для нашего протокола 4 + 2.

Как и в разделе II, мы предполагаем, что Ева осуществляет стратегию перехвата/передачи и пытается получить как можно больше информации о состоянии, отправленном Алисой. Это получается путем проецирования на ортогональный базис B sym = (i, j), как показано на рис. 2 [15], и дает Еве только вероятностную информацию. Другим методом для Евы было бы использовать ту же POVM, что и Боб. Это обеспечит ее меньшим количеством детерминированной информации. Коэффициент ошибок, вносимых Евой, равен вероятности неправильного чтения, например, вероятности получения j, когда на самом деле входные данные были . При такой стратегии подслушивания канал передачи Алиса-Ева известен как двоичный симметричный канал и полностью характеризуется коэффициентом ошибок q [18]. Взаимная информация, которой делятся Алиса и Ева, равна пропускной способности канала и задается [16]: b - это максимальная информация, которую можно извлечь из двух состояний с перекрытием cos b. С другой стороны, после того, как Боб отбрасывает все свои неубедительные результаты, канал передачи Ева-Боб является идеальным. Поэтому взаимная информация Ева-Боб равна:i EB = 1 .
(8)Эта стратегия, когда Ева подслушивает все передаваемые фотоны, создаст высокий коэффициент ошибок. Чтобы уменьшить его, Ева должна подслушивать только часть n передаваемых фотонов, создавая таким образом коэффициент ошибок Q = nq = n.

Теперь легко получить взаимную информацию между Алисой и Евой, I AE, и между (2)Евой и Бобом, I EB, как функцию коэффициента ошибок Q и угла b между состояниями: мы также можем записать взаимную информацию как функцию скорости передачи для каждого значения коэффициента ошибок. Эти функции построены на рис. 3, где в качестве эталона используется информация, полученная для системы из 4 состояний.

\subsubsection{Протокол 4 + 2}

Основная идея этого протокола заключается в том, что схема с 4 состояниями не требует, чтобы два состояния в каждом базисе были ортогональными. Безопасность этой схемы полностью зависит от двух пунктов (i) и (ii), упомянутых в Разделе II. Любая схема, использующая две пары состояний (каждая пара соответствует одному неортонормальному базису), удовлетворяющая и (i), и (ii), является одинаково хорошим кандидатом для 4-статусного протокола. Более того, выбирая неортогональные состояния в каждой паре, мы получим дополнительное преимущество 2-статусного протокола, а именно то, что Ева не может детерминированно различать два состояния в каждом базисе. Как мы покажем далее, это сделает схему более чувствительной к подслушиванию. Второе преимущество, общее с системой двух состояний, заключается в том, что эта схема будет более устойчивой в случае линии передачи с потерями. Этот аспект будет обсуждаться в разделе V. Графическое сравнение между различными системами приведено на рис. 4, где мы изображаем различные состояния на сфере Пуанкаре.

Давайте применим это к нашей предыдущей схеме кодирования фазы с параллельным отсчетом. Первая пара будет соответствовать фазовым сдвигам 0 и p, а вторая пара - p/2 и 3p/2. В явном виде, четыре состояния это: |ai, | - ai, |iai и | - iai. Подчеркнем, что эти состояния удовлетворяют условию (i) только при достаточно низкой интенсивности, поскольку импульсы, содержащие два или более фотонов, не удовлетворяют ему. Действительно, если принять во внимание состояние с числом фотонов два, то легко видеть, что две пары: | +- ai и | +- iai не находятся даже в одном и том же двумерном гильбертовом пространстве, и поэтому не могут соответствовать одной и той же матрице плотности. В дальнейшем мы будем считать, что это условие проверяется. Однако мы снимем это ограничение в разделе V, где мы представим анализ для линии передачи с потерями.

Система обнаружения аналогична той, что описана в разделе III, с добавлением фазового сдвига p/2 в одном плече интерферометра (см. рис. 1). Когда Боб хочет измерить в первом базисе, он не ставит фазовый сдвиг, и поэтому его схема обнаружения будет различать |ai и | - pi. Когда он хочет измерить во втором базисе, он вводит фазовый сдвиг p/2, так что его схема обнаружения теперь будет различать|iai и | - iai. Конечно, когда Боб использует неправильный базис (скажем, Алиса послала состояние |ai, а Боб положил фазовый сдвиг p/2), результат Боба совершенно не связан с выбором Алисы. Во многих случаях Боб не получит никаких отсчетов в своих детекторах D2 и D3, которые соответствуют окончательным результатам, и будет отброшен.

Теперь перед Евой стоят две проблемы: она не знает, какой базис использовала Алиса (проблема метода 4-х состояний), а это значит, что даже получив убедительный результат, она не может быть уверена, что он релевантен. Более того, поскольку состояния не ортогональны, она сталкивается с двумя возможностями: либо попытаться получить детерминированные результаты, что означает, что во многих случаях она вообще не получит никакой информации, но все равно должна будет принять решение о том, какое состояние послать Бобу; либо попытаться получить вероятностную информацию, в этом случае она будет знать очень мало о каждом бите. В обоих случаях она будет вносить ошибки еще до того, как начнет работать с базисом. В этом заключается основное отличие от обычной схемы с 4 состояниями: Алиса и Боб используют тот факт, что они посылают слабые импульсы, а не одиночные фотоны, для повышения безопасности.

Сравнение между тремя системами приведено на рис. 3, где мы строим график различной информации как функции скорости передачи, и используем 4-статусную систему в качестве эталона. Обратите внимание, что, поскольку скорость передачи различна для 2-статусной системы и системы 4+2, мы сравниваем системы с различными значениями a (или, эквивалентно, с различными значениями cos перекрытия b). При рассматриваемом здесь типе стратегии подслушивания информация, доступная Еве, линейно растет с коэффициентом ошибок для всех систем. Поэтому, поскольку график нормирован относительно 4-статусной системы, зависимость от Q отсутствует. Рис. 3 показывает явное преимущество 2-статусной системы по отношению к 4-статусной при очень низкой скорости передачи. Однако информация, просочившаяся к Еве, быстро увеличивается с ростом скорости передачи. Напротив, система 4+2 всегда предпочтительнее обеих других систем. Подчеркнем, что наш анализ в принципе корректен для любого значения коэффициента перекрытия cos b между состояниями, если различные состояния остаются в двумерном гильбертовом пространстве. Однако это не так для предложенной реализации со слабыми когерентными состояниями. В этом случае анализ подходит только для очень слабых состояний, где вероятность наличия более одного фотона достаточно мала, и, следовательно, где перекрытие между состояниями всегда близко к единице. Это, вероятно, верно в практических приложениях, но все же важно представить поправки к анализу, когда двухфотонные состояния становятся актуальными. Этой задаче посвящен раздел V.

\subsubsection{Линия передачи с потерями}

В вышеупомянутой работе мы проанализировали относительную чувствительность различных схем к подслушиванию, исходя из предположения, что на каждый импульс приходится не более одного фотона. Однако, когда мы используем импульсы когерентного или теплового света, существует ненулевая вероятность наличия более одного фотона в импульсе, даже для очень слабых импульсов. Когда линия передачи между Алисой и Бобом примерно без потерь, тот факт, что в нескольких импульсах может быть более одного фотона, не слишком вреден, а лишь дает некоторую свободную информацию подслушивающему. Однако, когда линия передачи имеет потери, использование слабых импульсов может оказаться губительным для Алисы и Боба. Предположим, что линия передачи представляет собой кварцевое оптическое волокно, которое всегда имеет небольшие потери (около 0,2 дБ/км). Если мы хотим использовать криптографическую систему на разумных расстояниях, скажем, до 50 км, потери при передаче будут достигать 10 дБ, или около 90. Подслушивающее устройство с более совершенной технологией может заменить волокно на абсолютно прозрачное и использовать избыточную мощность в своих злонамеренных целях.

Для системы 4-х состояний, основанной на поляризации (раздел II), это может быть очень вредным. Действительно, поскольку поляризация и количество фотонов являются независимыми переменными, в принципе, нет никакой проблемы выбрать несколько импульсов с двумя или более фотонами и разделить их на два однофотонных импульса, не меняя поляризации. Затем Ева может послать один из этих двух импульсов Бобу, а другой оставить себе. Она измерит свой сигнал только после того, как Алиса и Боб раскроют свои базы, что означает, что она получит полную информацию об этих импульсах. Если импульсы, посланные Алисой, когерентны и содержат в среднем 1/10 фотона, Ева получит примерно один такой импульс из 200 и отправит все эти импульсы Бобу без затухания. Помня, что Боб ожидает получить только один фотон из 100 импульсов, посланных Алисой, мы видим, что Ева может знать поляризацию половины импульсов, полученных Бобом, без создания какой-либо ошибки. Для теплового света, где распределение фотонов шире (один импульс из 100 будет содержать более одного фотона), Ева фактически будет знать поляризацию всех импульсов. Это, конечно, можно уменьшить, используя еще более слабые импульсы, но это, в свою очередь, снизит скорость передачи и отношение сигнал/шум (в основном из-за темновых отсчетов детекторов). Это показывает, что сочетание слабых импульсов с высокими потерями в канале является опасным для этой криптографической системы. Если потери достаточно велики, Ева может получить полную информацию о передаче, и это без единой ошибки. Подчеркнем, однако, что любая система, использующая только одиночные фотоны, будет нечувствительна к вышеописанной атаке.

В отличие от 4-статусной системы, как 2-статусные системы, основанные на фазовом кодировании (раздел III), так и наш новый протокол (раздел IV) будут более устойчивы к этой атаке. Основная причина заключается в том, что поскольку фаза и число являются сопряженными переменными, любая попытка Евы выбрать двухфотонные импульсы неизбежно рандомизирует фазу импульса. Поэтому лучшее, что может сделать Ева, это разделить входящие импульсы и послать Бобу более слабые импульсы через волокно без потерь. Для 90\% потерь, упомянутых выше, Ева может разделить 90\% импульсов. Боб, конечно, не может узнать, что потери теперь происходят по вине Евы. Теперь Ева может хранить свои импульсы, ждать, пока Алиса и Боб раскроют используемую ими основу, а затем попытаться извлечь из них максимум информации. В отличие от системы с 4 состояниями, ее информация ограничена тем фактом, что состояния не ортогональны. Фактически, максимальная информация, которую она может извлечь, задается ib, определенным в (7). Для приведенного выше примера, с 1/10 фотона на импульс в среднем и 90\% потерь, Ева имеет в своем распоряжении импульсы с 0,09 фотонами. Максимальная информация, которую она может извлечь, составляет около 0,23 бита. В практической схеме эта информация должна быть добавлена к информации, доступной Еве, как функция коэффициента ошибок. Подчеркнем, что Ева может использовать эту стратегию разделения луча даже в случае 4-позиционных систем со слабыми импульсами. Однако, как было показано в предыдущем параграфе, в этом случае она также может использовать независимость поляризации и числа фотонов для получения дополнительной информации. 


\subsubsection{Заключение}

Правила игры в квантовой криптографии заключаются в том, что честные участники ограничены доступными технологиями, в то время как подслушиватель ограничен только законами квантовой механики. Это делается для того, чтобы безопасность схем не зависела от будущих технологических достижений, какими бы маловероятными они ни были. В настоящее время одним из основных технологических ограничений является сложность генерации одиночных фотонов. По этой причине большинство существующих схем полагаются на слабые импульсы, которые легко генерировать. Однако в практических реализациях [3,7,8] этот факт рассматривался лишь как ограничение. Тот факт, что импульсы имели сильную вакуумную составляющую, или, эквивалентно, тот факт, что два импульса в одном базисе не были ортогональными, не использовался пользователями. В данной работе мы представили новую систему, которая использует этот вакуумный компонент для повышения безопасности передачи.

Причина, по которой задача подслушивающего усложняется с помощью этой системы, заключается в том, что она сочетает в себе сильные стороны двух систем, на основе которых она построена: как и в 4-статусной системе, Ева не знает базиса, используемого Алисой и Бобом; как и в 2-статусной системе, она не может с уверенностью отличить два неортогональных состояния. Стоит отметить, что обычная реализация 4-позиционной системы со слабыми импульсами фактически удовлетворяет этим двум критериям. Слабые импульсы с ортогональными поляризациями не являются ортогональными в гильбертовом пространстве из-за их общей вакуумной компоненты. Ингредиент, которого не хватает в этой системе, - это использование сильного опорного импульса при обнаружении, который гарантирует, что Ева должна послать сигнал Бобу, даже если она не смогла получить никакой информации о сигнале, посланном Алисой. Когда это добавляется в систему, использование слабых импульсов становится преимуществом для легитимных пользователей. Действительно, одна из экспериментальных реализаций квантовой криптографии, основанная на интерферометрической схеме [7], несколько похожа на предложенную нами реализацию (см. рис. 1). Основное различие между этими двумя схемами заключается в том, что в [7] не используется сильный опорный импульс (в их установке |b| 2 = |a| 2 , а делитель луча BS1 заменен зеркалом). Поэтому, как подчеркивалось выше, их схема не использует преимущества неортогональности слабых импульсов. Всякий раз, когда она получает неудовлетворительный результат при попытке подслушивания, Ева может просто заблокировать передачу и ничего не посылать Бобу. Поэтому небольшая модификация существующего эксперимента может обеспечить гораздо более безопасную схему.

\subsection{\review}
ss
\subsection{\dic}
ss